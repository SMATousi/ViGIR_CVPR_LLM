100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:15<00:00,  3.92s/it]
Precision: 0.5021
Recall: 0.9480
F1 Score: 0.6565
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [02:40<00:00,  2.39s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:13<00:00,  3.42s/it]
Precision: 0.5649
Recall: 0.6440
F1 Score: 0.6019
Epoch [1/10], Loss: 0.6589
 19%|████████████████████▉                                                                                       | 13/67 [00:35<02:29,  2.77s/it]
Traceback (most recent call last):
  File "/home/macula/SMATousi/CVPR/ViGIR_CVPR_LLM/weak_supervision_framework/run_WS_on_hateful.py", line 169, in <module>
    main()
  File "/home/macula/SMATousi/CVPR/ViGIR_CVPR_LLM/weak_supervision_framework/run_WS_on_hateful.py", line 151, in main
    train_model(model,
  File "/home/macula/SMATousi/CVPR/ViGIR_CVPR_LLM/weak_supervision_framework/utils.py", line 60, in train_model
    outputs = model(images)
              ^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/CVPR/ViGIR_CVPR_LLM/weak_supervision_framework/model.py", line 59, in forward
    image_features = self.clip_model.get_image_features(pixel_values=image)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/transformers/models/clip/modeling_clip.py", line 1248, in get_image_features
    vision_outputs = self.vision_model(
                     ^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/transformers/models/clip/modeling_clip.py", line 1043, in forward
    encoder_outputs = self.encoder(
                      ^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/transformers/models/clip/modeling_clip.py", line 824, in forward
    layer_outputs = encoder_layer(
                    ^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/transformers/models/clip/modeling_clip.py", line 569, in forward
    hidden_states = self.mlp(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/transformers/models/clip/modeling_clip.py", line 525, in forward
    hidden_states = self.activation_fn(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/macula/SMATousi/.conda/envs/snorkel/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
